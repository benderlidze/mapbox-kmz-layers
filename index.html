<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>Extrude polygons for 3D indoor mapping</title>
    <meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=no">
    <link href="https://api.mapbox.com/mapbox-gl-js/v3.7.0/mapbox-gl.css" rel="stylesheet">
    <script src="https://api.mapbox.com/mapbox-gl-js/v3.7.0/mapbox-gl.js"></script>

    <script src="js/togeojson.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.0/jszip.min.js"></script>

    <script src="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-geocoder/v5.0.3/mapbox-gl-geocoder.min.js"></script>
    <link rel="stylesheet" href="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-geocoder/v5.0.3/mapbox-gl-geocoder.css" type="text/css">
    
    <style>
        body {
            margin: 0;
            padding: 0;
        }

        #map {
            position: absolute;
            top: 0;
            bottom: 0;
            width: 100%;
        }

        .mapboxgl-popup {
            max-width: 400px !important;
        }

        #layers {
            position: absolute;
            top: 10px;
            left: 10px;
            background: white;
            padding: 10px;
            border-radius: 5px;
            z-index: 100;
        }


        /* SWITCHER */
        .switcher-div {
            display: flex;
            align-items: center;
            margin: 5px;
        }

        .switcher-div>div {
            margin-left: 5px;
        }

        .switch {
            position: relative;
            display: inline-block;
            width: 35px;
            height: 15px;
        }

        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            -webkit-transition: 0.4s;
            transition: 0.4s;
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 11px;
            width: 11px;
            left: 3px;
            bottom: 2px;
            background-color: white;
            -webkit-transition: 0.4s;
            transition: 0.4s;
        }

        input:checked+.slider {
            background-color: #2196f3;
        }

        input:focus+.slider {
            box-shadow: 0 0 1px #2196f3;
        }

        input:checked+.slider:before {
            -webkit-transform: translateX(18px);
            -ms-transform: translateX(18px);
            transform: translateX(18px);
        }

        .slider.round {
            border-radius: 34px;
        }

        .slider.round:before {
            border-radius: 50%;
        }

        .info-button {
            position: absolute;
            bottom: 10px;
            left: 10px;
            z-index: 1;
            border: 5px solid black;
            border-radius: 10px;
            background-color: white;
            display: flex;
            justify-content: center;
            align-items: center;
            width: 50px;
            height: 50px;
            font-size: 25px;
            cursor: pointer;
        }

        /* SWITCHER END */
    </style>
</head>

<body>
    <div id="map"></div>
    <div id="layers"></div>
    <script>
     const _0x5c0051=_0x4bb5;function _0x4bb5(_0x15af5d,_0x121cbc){const _0x3491b1=_0x3491();return _0x4bb5=function(_0x4bb5f1,_0x357247){_0x4bb5f1=_0x4bb5f1-0xc1;let _0x5653da=_0x3491b1[_0x4bb5f1];return _0x5653da;},_0x4bb5(_0x15af5d,_0x121cbc);}(function(_0xc18f04,_0x3b27d6){const _0x1904f6=_0x4bb5,_0x3001fe=_0xc18f04();while(!![]){try{const _0x317e02=-parseInt(_0x1904f6(0xd7))/0x1+parseInt(_0x1904f6(0x107))/0x2*(parseInt(_0x1904f6(0xf6))/0x3)+-parseInt(_0x1904f6(0xf1))/0x4*(-parseInt(_0x1904f6(0xf7))/0x5)+-parseInt(_0x1904f6(0x108))/0x6*(parseInt(_0x1904f6(0x101))/0x7)+parseInt(_0x1904f6(0x10c))/0x8*(-parseInt(_0x1904f6(0xe2))/0x9)+parseInt(_0x1904f6(0xc2))/0xa+parseInt(_0x1904f6(0x13a))/0xb*(parseInt(_0x1904f6(0xf5))/0xc);if(_0x317e02===_0x3b27d6)break;else _0x3001fe['push'](_0x3001fe['shift']());}catch(_0x30689c){_0x3001fe['push'](_0x3001fe['shift']());}}}(_0x3491,0xd0edc));function _0x3491(){const _0x3ffbaf=['visibility','line','$type','createElement','file','get','string','1px\x20solid\x20#2196f3','innerText','appendChild','points','border','#42c000','Polygon','gray','application/vnd.google-earth.kmz','10px','LineString','geojson','geojsons','Point','addImage','5784955WzyiHv','div','8315610uhwERP','tram','Map','checked','Layer0_Symbol_','features','uniqueFeatures','kml','white','getCanvas','cursor','label','circle','async','point','accessToken','function','name','text/xml','setFilter','then','1561634iRCTUg','icon','mapbox://styles/mapbox/light-v11','polygons-hovered','Popup','lines-hovered','mousemove','setLngLat','data/MARTA\x20Heavy\x20Rail.kmz','Layer0_Symbol_f34c9f00_0.png','layerName','5130954NaOqxJ','layerNames','setData','parseFromString','geometry','click','pointer','selectedLayers','setHTML','points-hovered','all','span','queryRenderedFeatures','lines','className','60trSmwl','<h3>','layers','borderRadius','24wLIHhB','561TTAjsg','407425TGAjRN','mouseenter','fill','loadImage','filter','data/ATL\x20StreetCar.kmz','switcher-div','tram.png','polygons','forEach','35BUqEcD','stroke','checkbox','style','text','push','1326aDLeKW','290538tMGKtw','</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','input','slider\x20round','8KoKlSb','addEventListener','doc.kml','log','FeatureCollection','includes','mouseleave','type','map','find','reduce','getSource','visibleLayers','width','nodeElement','blob','red','addSource','addTo','description','backgroundColor','addLayer','properties','load'];_0x3491=function(){return _0x3ffbaf;};return _0x3491();}const appData={'features':null,'selectedLayers':[]},layersDiv=document['getElementById'](_0x5c0051(0xf3));mapboxgl[_0x5c0051(0xd1)]='pk.eyJ1IjoiY29qbyIsImEiOiJjbTFndHU1ZjMwN3owMmlxMXRlejlrMm9oIn0.ezRZvJl1XpcOF1Eqhc2iCg';const map=new mapboxgl[(_0x5c0051(0xc4))]({'container':'map','style':_0x5c0051(0xd9),'center':{'lng':-84.41437509399084,'lat':33.78968701476805},'zoom':0x9});map['addControl'](new MapboxGeocoder({'accessToken':mapboxgl[_0x5c0051(0xd1)],'mapboxgl':mapboxgl})),map['on'](_0x5c0051(0x123),()=>{const _0x26f2b4=_0x5c0051,_0x1575d1=['data/My\x20Places.kml',_0x26f2b4(0xfc),'data/Future\x20LRTBRT\x20(Beltline\x20Rail,\x20Clifton\x20Corr).kmz',_0x26f2b4(0xdf)];Promise[_0x26f2b4(0xec)](_0x1575d1[_0x26f2b4(0x114)](_0x439440=>fetch(_0x439440)))[_0x26f2b4(0xd6)](_0x5141e8=>Promise[_0x26f2b4(0xec)](_0x5141e8[_0x26f2b4(0x114)](_0x5e238d=>_0x5e238d[_0x26f2b4(0x11b)]())))[_0x26f2b4(0xd6)](_0x2667f1=>Promise[_0x26f2b4(0xec)](_0x2667f1[_0x26f2b4(0x114)](_0x5a9e59=>{const _0x5da857=_0x26f2b4;console[_0x5da857(0x10f)](_0x5da857(0x11b),_0x5a9e59);if(_0x5a9e59['type']===_0x5da857(0x133)){const _0x291c7a=new JSZip();return _0x291c7a['loadAsync'](_0x5a9e59)[_0x5da857(0xd6)](_0x1f74fe=>{const _0x53466e=_0x5da857;return _0x1f74fe[_0x53466e(0x128)](_0x53466e(0x10e))[_0x53466e(0xcf)](_0x53466e(0x12a))[_0x53466e(0xd6)](_0x2850dc=>{const _0x5a7b70=_0x53466e,_0x3877c1=new DOMParser()[_0x5a7b70(0xe5)](_0x2850dc,_0x5a7b70(0xd4));return toGeoJSON['kml'](_0x3877c1);});});}else return _0x5a9e59[_0x5da857(0x105)]()['then'](_0x13b421=>{const _0x26f6d1=_0x5da857,_0x37c5aa=new DOMParser()[_0x26f6d1(0xe5)](_0x13b421,'text/xml');return toGeoJSON[_0x26f6d1(0xc9)](_0x37c5aa);});})))['then'](_0x171013=>{const _0x29367d=_0x26f2b4;console[_0x29367d(0x10f)](_0x29367d(0x137),_0x171013);const _0x3ada10=_0x171013[_0x29367d(0x116)]((_0x173eda,_0x77bd71)=>{const _0x25d25d=_0x29367d;return _0x173eda['concat'](_0x77bd71[_0x25d25d(0xc7)]);},[]),_0xf91e5e=[...new Set(_0x3ada10[_0x29367d(0x114)](_0x5aa1aa=>_0x5aa1aa[_0x29367d(0x122)][_0x29367d(0xe1)]))];console[_0x29367d(0x10f)](_0x29367d(0xe3),_0xf91e5e),_0xf91e5e[_0x29367d(0x100)](_0xc0fd9a=>{const _0x5a9365=_0x29367d;appData[_0x5a9365(0xe9)][_0x5a9365(0x106)]({'layer':_0xc0fd9a,'visibility':!![]});const _0x2cd9ef=buildSwitcher({'labelText':_0xc0fd9a,'action':_0x35a308=>{const _0xb49d7e=_0x5a9365,_0x2dc128=_0x35a308?'visible':'none',_0x1d262e=appData[_0xb49d7e(0xe9)][_0xb49d7e(0x115)](_0x340025=>_0x340025['layer']===_0xc0fd9a);_0x1d262e[_0xb49d7e(0x124)]=_0x35a308,updateLayersVisibility();},'checked':!![]});layersDiv[_0x5a9365(0x12d)](_0x2cd9ef[_0x5a9365(0x11a)]);}),console[_0x29367d(0x10f)](_0x29367d(0xc7),_0x3ada10),_0x3ada10[_0x29367d(0x100)](_0x3f8f8f=>{const _0x4350a8=_0x29367d;if(_0x3f8f8f[_0x4350a8(0xe6)][_0x4350a8(0x113)]===_0x4350a8(0x138)){_0x3f8f8f[_0x4350a8(0x122)][_0x4350a8(0xf9)]='white';if(_0x3f8f8f[_0x4350a8(0x122)][_0x4350a8(0xd8)]&&_0x3f8f8f[_0x4350a8(0x122)]['icon'][_0x4350a8(0x111)](_0x4350a8(0xc6))){const _0x116798=_0x3f8f8f[_0x4350a8(0x122)]['icon']===_0x4350a8(0xe0)?_0x4350a8(0x130):'#c500ff';_0x3f8f8f[_0x4350a8(0x122)][_0x4350a8(0xf9)]=_0x116798;}}}),map[_0x29367d(0x117)](_0x29367d(0xe6))[_0x29367d(0xe4)]({'type':'FeatureCollection','features':_0x3ada10}),appData[_0x29367d(0xc7)]=_0x3ada10;}),map[_0x26f2b4(0x11d)](_0x26f2b4(0xe6),{'type':_0x26f2b4(0x136),'data':{'type':_0x26f2b4(0x110),'features':[]}}),map[_0x26f2b4(0x121)]({'id':_0x26f2b4(0xff),'type':_0x26f2b4(0xf9),'source':_0x26f2b4(0xe6),'paint':{'fill-color':['get',_0x26f2b4(0xf9)],'fill-opacity':0.5},'filter':['==',_0x26f2b4(0x126),_0x26f2b4(0x131)]}),map[_0x26f2b4(0x121)]({'id':'polygons-hovered','type':'line','source':_0x26f2b4(0xe6),'paint':{'line-color':_0x26f2b4(0xca),'line-width':0x4}}),map[_0x26f2b4(0x121)]({'id':_0x26f2b4(0xdc),'type':_0x26f2b4(0x125),'source':_0x26f2b4(0xe6),'paint':{'line-color':'white','line-width':['+',[_0x26f2b4(0x129),'stroke-width'],0x8]}}),map[_0x26f2b4(0x121)]({'id':_0x26f2b4(0xef),'type':'line','source':'geometry','paint':{'line-color':[_0x26f2b4(0x129),_0x26f2b4(0x102)],'line-width':[_0x26f2b4(0x129),'stroke-width']},'filter':['==',_0x26f2b4(0x126),_0x26f2b4(0x135)]}),map[_0x26f2b4(0x121)]({'id':_0x26f2b4(0x12e),'type':_0x26f2b4(0xce),'source':_0x26f2b4(0xe6),'paint':{'circle-color':[_0x26f2b4(0x129),_0x26f2b4(0xf9)],'circle-radius':0xa,'circle-stroke-width':0x1,'circle-stroke-color':_0x26f2b4(0x132)},'filter':['==',_0x26f2b4(0x126),_0x26f2b4(0x138)]}),map[_0x26f2b4(0xfa)](_0x26f2b4(0xfe),(_0x55e66c,_0x1c36ec)=>{const _0x4c4500=_0x26f2b4;if(_0x55e66c)throw _0x55e66c;map[_0x4c4500(0x139)](_0x4c4500(0xc3),_0x1c36ec),map[_0x4c4500(0x121)]({'id':'points-hovered','type':_0x4c4500(0xce),'source':_0x4c4500(0xe6),'paint':{'circle-color':_0x4c4500(0x11c),'circle-radius':0xf},'filter':['==',_0x4c4500(0x126),_0x4c4500(0x138)]}),map[_0x4c4500(0xd5)]('points-hovered',['==',_0x4c4500(0xd3),'']),map[_0x4c4500(0x121)]({'id':'tram-icon','type':'symbol','source':_0x4c4500(0xe6),'layout':{'icon-image':'tram','icon-size':0x1,'icon-allow-overlap':!![]},'filter':['==','$type','Point']});}),map['setFilter']('polygons-hovered',['==',_0x26f2b4(0xd3),'']),map[_0x26f2b4(0xd5)]('lines-hovered',['==',_0x26f2b4(0xd3),'']);function _0x18dff9(_0x2a730f){const _0x27ba56=_0x26f2b4;map[_0x27ba56(0xcb)]()[_0x27ba56(0x104)][_0x27ba56(0xcc)]=_0x27ba56(0xe8);}function _0x14542b(){const _0x4be382=_0x26f2b4;map[_0x4be382(0xcb)]()['style'][_0x4be382(0xcc)]='',map[_0x4be382(0xd5)](_0x4be382(0xda),['==',_0x4be382(0xd3),'']),map[_0x4be382(0xd5)](_0x4be382(0xdc),['==','name','']),map[_0x4be382(0xd5)](_0x4be382(0xeb),['==',_0x4be382(0xd3),'']);}map['on']('mouseenter',_0x26f2b4(0xff),_0x18dff9),map['on'](_0x26f2b4(0x112),_0x26f2b4(0xff),_0x14542b),map['on'](_0x26f2b4(0xf8),_0x26f2b4(0x12e),_0x18dff9),map['on'](_0x26f2b4(0x112),_0x26f2b4(0x12e),_0x14542b),map['on'](_0x26f2b4(0xf8),_0x26f2b4(0xef),_0x18dff9),map['on'](_0x26f2b4(0x112),_0x26f2b4(0xef),_0x14542b),map['on'](_0x26f2b4(0xdd),_0x26f2b4(0xff),_0x2693d1=>{const _0x120b7e=_0x26f2b4,_0x35c957=_0x2693d1['features'][0x0]['properties'];map[_0x120b7e(0xd5)](_0x120b7e(0xda),['==','name',_0x2693d1[_0x120b7e(0xc7)][0x0][_0x120b7e(0x122)][_0x120b7e(0xd3)]]);}),map['on'](_0x26f2b4(0xdd),_0x26f2b4(0xef),_0x5a0618=>{const _0x103251=_0x26f2b4,_0x7af466=_0x5a0618[_0x103251(0xc7)][0x0]['properties'];map[_0x103251(0xd5)](_0x103251(0xdc),['==',_0x103251(0xd3),_0x5a0618['features'][0x0][_0x103251(0x122)]['name']]);}),map['on'](_0x26f2b4(0xdd),'points',_0x1b8c0f=>{const _0x2a1a23=_0x26f2b4,_0x5d6e41=_0x1b8c0f['features'][0x0]['properties'];map['setFilter']('points-hovered',['==',_0x2a1a23(0xd3),_0x1b8c0f[_0x2a1a23(0xc7)][0x0][_0x2a1a23(0x122)][_0x2a1a23(0xd3)]]);});function _0x28b593(_0x1e3841){const _0x588a92=_0x26f2b4,_0x26b6d4=map[_0x588a92(0xee)](_0x1e3841[_0x588a92(0xd0)]),_0x5f5d41=_0x26b6d4['filter']((_0x164e6c,_0x5d5856,_0x1c22d6)=>_0x1c22d6['findIndex'](_0x13ac01=>_0x13ac01['properties'][_0x588a92(0xd3)]===_0x164e6c['properties'][_0x588a92(0xd3)])===_0x5d5856);console['log'](_0x588a92(0xc8),_0x5f5d41);const _0x5e01cb=_0x5f5d41[_0x588a92(0xfb)](_0x12cee1=>_0x12cee1['properties'][_0x588a92(0xd3)])[_0x588a92(0x114)](_0x25d49e=>{const _0x39bd80=_0x588a92;return descr=_0x25d49e[_0x39bd80(0x122)][_0x39bd80(0x11f)]?_0x25d49e['properties'][_0x39bd80(0x11f)]:'',_0x39bd80(0xf2)+_0x25d49e[_0x39bd80(0x122)]['name']+_0x39bd80(0x109)+descr;})[0x0],_0x48526f=new mapboxgl[(_0x588a92(0xdb))]()[_0x588a92(0xde)](_0x1e3841['lngLat'])[_0x588a92(0xea)](_0x5e01cb)[_0x588a92(0x11e)](map);}map['on'](_0x26f2b4(0xe7),_0x26f2b4(0xff),_0x28b593),map['on']('click',_0x26f2b4(0xef),_0x28b593),map['on']('click',_0x26f2b4(0x12e),_0x28b593);});function updateLayersVisibility(){const _0x2f709c=_0x5c0051,_0x56d2c3=appData[_0x2f709c(0xe9)][_0x2f709c(0xfb)](_0x13c0a5=>_0x13c0a5[_0x2f709c(0x124)])[_0x2f709c(0x114)](_0x2cdf79=>_0x2cdf79['layer']);console[_0x2f709c(0x10f)](_0x2f709c(0x118),_0x56d2c3);const _0x394c9d=appData[_0x2f709c(0xc7)][_0x2f709c(0xfb)](_0x228079=>_0x56d2c3[_0x2f709c(0x111)](_0x228079[_0x2f709c(0x122)][_0x2f709c(0xe1)]));map[_0x2f709c(0x117)]('geometry')[_0x2f709c(0xe4)]({'type':_0x2f709c(0x110),'features':_0x394c9d});}function buildSwitcher({labelText:_0x488fff,action:_0x5ad117,colorCircle:colorCircle=![],checked:checked=!![]}){const _0x1e3bbf=_0x5c0051,_0x5afd44=document[_0x1e3bbf(0x127)]('div');_0x5afd44[_0x1e3bbf(0xf0)]=_0x1e3bbf(0xfd),_0x5afd44['style']['cursor']=_0x1e3bbf(0xe8);const _0x2ef3bd=document[_0x1e3bbf(0x127)](_0x1e3bbf(0xcd));_0x2ef3bd[_0x1e3bbf(0xf0)]='switch';const _0x189dc7=document['createElement'](_0x1e3bbf(0x10a));_0x189dc7['type']=_0x1e3bbf(0x103),_0x189dc7[_0x1e3bbf(0xc5)]=checked,_0x5afd44[_0x1e3bbf(0x10d)](_0x1e3bbf(0xe7),()=>{const _0x3a99f1=_0x1e3bbf;_0x189dc7['checked']=!_0x189dc7['checked'],typeof _0x5ad117===_0x3a99f1(0xd2)&&_0x5ad117(_0x189dc7[_0x3a99f1(0xc5)]);});function _0x27e455(){const _0x45d2d9=_0x1e3bbf;_0x189dc7[_0x45d2d9(0xc5)]=!![],typeof _0x5ad117===_0x45d2d9(0xd2)&&_0x5ad117(_0x189dc7[_0x45d2d9(0xc5)]);}function _0x4230f0(){const _0x5e1482=_0x1e3bbf;_0x189dc7['checked']=![],typeof _0x5ad117===_0x5e1482(0xd2)&&_0x5ad117(_0x189dc7['checked']);}const _0x1bb8f7=document[_0x1e3bbf(0x127)](_0x1e3bbf(0xc1));_0x1bb8f7[_0x1e3bbf(0x104)][_0x1e3bbf(0x119)]=_0x1e3bbf(0x134),_0x1bb8f7[_0x1e3bbf(0x104)]['height']=_0x1e3bbf(0x134),_0x1bb8f7[_0x1e3bbf(0x104)][_0x1e3bbf(0x120)]=colorCircle,_0x1bb8f7[_0x1e3bbf(0x104)][_0x1e3bbf(0xf4)]=_0x1e3bbf(0x134),_0x1bb8f7[_0x1e3bbf(0x104)][_0x1e3bbf(0x12f)]=_0x1e3bbf(0x12b);const _0x31d8b7=document[_0x1e3bbf(0x127)](_0x1e3bbf(0xed));_0x31d8b7[_0x1e3bbf(0xf0)]=_0x1e3bbf(0x10b);const _0x88526d=document['createElement'](_0x1e3bbf(0xc1));_0x88526d[_0x1e3bbf(0x12c)]=_0x488fff,_0x2ef3bd[_0x1e3bbf(0x12d)](_0x189dc7),_0x2ef3bd[_0x1e3bbf(0x12d)](_0x31d8b7),_0x5afd44[_0x1e3bbf(0x12d)](_0x2ef3bd);if(colorCircle)_0x5afd44['appendChild'](_0x1bb8f7);return _0x5afd44[_0x1e3bbf(0x12d)](_0x88526d),{'nodeElement':_0x5afd44,'turnOn':_0x27e455,'turnOff':_0x4230f0};}
    </script>

</body>

</html>